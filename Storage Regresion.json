{
	"info": {
		"_postman_id": "13aef89d-ca2b-4ecb-aff1-5bbfcab3f228",
		"name": "Storage Regresion",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "46342407",
		"_collection_link": "https://api-team-3832.postman.co/workspace/5c1d33f3-ef95-474d-8798-e0818eca836f/collection/46342407-13aef89d-ca2b-4ecb-aff1-5bbfcab3f228?action=share&source=collection_link&creator=46342407"
	},
	"item": [
		{
			"name": "InsurancePolicy Regresion",
			"item": [
				{
					"name": "Insured policy cod_int OK",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// ===================================",
									"// 1. RESPONSE STRUCTURE AND STATUS",
									"// ===================================",
									"pm.test(\"Status code is 200 (OK)\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has valid JSON body\", function () {",
									"    pm.response.to.be.json;",
									"});",
									"",
									"pm.test(\"Response has required root-level fields\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('pageSize');",
									"    pm.expect(jsonData).to.have.property('pageNumber');",
									"    pm.expect(jsonData).to.have.property('totalPages');",
									"    pm.expect(jsonData).to.have.property('totalElements');",
									"    pm.expect(jsonData).to.have.property('items');",
									"});",
									"",
									"pm.test(\"Response Content-Type header is application/json\", function () {",
									"    pm.expect(pm.response.headers.get('Content-Type')).to.include('application/json');",
									"});",
									"",
									"// ===================================",
									"// 2. PAGINATION DETAILS",
									"// ===================================",
									"pm.test(\"Pagination fields have correct data types\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData.pageSize).to.be.a('number');",
									"    pm.expect(jsonData.pageNumber).to.be.a('number');",
									"    pm.expect(jsonData.totalPages).to.be.a('number');",
									"    pm.expect(jsonData.totalElements).to.be.a('number');",
									"});",
									"",
									"pm.test(\"Pagination values are valid\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData.pageSize).to.be.at.least(0);",
									"    pm.expect(jsonData.pageNumber).to.be.at.least(1);",
									"    pm.expect(jsonData.totalPages).to.be.at.least(0);",
									"    pm.expect(jsonData.totalElements).to.be.at.least(0);",
									"});",
									"",
									"pm.test(\"Items array length does not exceed pageSize\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData.items.length).to.be.at.most(jsonData.pageSize);",
									"});",
									"",
									"pm.test(\"Total pages calculation is correct\", function () {",
									"    const jsonData = pm.response.json();",
									"    const expectedTotalPages = jsonData.pageSize > 0 ? Math.ceil(jsonData.totalElements / jsonData.pageSize) : 0;",
									"    pm.expect(jsonData.totalPages).to.equal(expectedTotalPages);",
									"});",
									"",
									"// ===================================",
									"// 3. ITEM DETAILS AND MANDATORY FIELDS",
									"// ===================================",
									"pm.test(\"Items is an array\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData.items).to.be.an('array');",
									"});",
									"",
									"pm.test(\"Each item has all mandatory fields\", function () {",
									"    const jsonData = pm.response.json();",
									"    const mandatoryFields = [",
									"        'portfolioId', 'policyNumber', 'policyInceptionDate', ",
									"        'policyStartDate', 'policyEndDate', 'thirdPartyInternalId',",
									"        'systemCode', 'commercialModeCodes', 'serviceModeCodes'",
									"    ];",
									"    ",
									"    jsonData.items.forEach(function (item, index) {",
									"        mandatoryFields.forEach(function (field) {",
									"            pm.expect(item, `Item ${index} missing field: ${field}`).to.have.property(field);",
									"        });",
									"    });",
									"});",
									"",
									"pm.test(\"Each item has valid field types\", function () {",
									"    const jsonData = pm.response.json();",
									"    ",
									"    jsonData.items.forEach(function (item, index) {",
									"        pm.expect(item.portfolioId, `Item ${index} portfolioId type`).to.be.a('string');",
									"        pm.expect(item.policyNumber, `Item ${index} policyNumber type`).to.be.a('string');",
									"        pm.expect(item.policyInceptionDate, `Item ${index} policyInceptionDate type`).to.be.a('string');",
									"        pm.expect(item.policyStartDate, `Item ${index} policyStartDate type`).to.be.a('string');",
									"        pm.expect(item.policyEndDate, `Item ${index} policyEndDate type`).to.be.a('string');",
									"        pm.expect(item.thirdPartyInternalId, `Item ${index} thirdPartyInternalId type`).to.be.a('string');",
									"        pm.expect(item.systemCode, `Item ${index} systemCode type`).to.be.a('string');",
									"        pm.expect(item.commercialModeCodes, `Item ${index} commercialModeCodes type`).to.be.an('array');",
									"        pm.expect(item.serviceModeCodes, `Item ${index} serviceModeCodes type`).to.be.an('array');",
									"    });",
									"});",
									"",
									"pm.test(\"Each item has valid nested structures\", function () {",
									"    const jsonData = pm.response.json();",
									"    ",
									"    jsonData.items.forEach(function (item, index) {",
									"        if (item.policyStatus) {",
									"            pm.expect(item.policyStatus, `Item ${index} policyStatus type`).to.be.an('object');",
									"            pm.expect(item.policyStatus).to.have.property('statusCode');",
									"        }",
									"        ",
									"        if (item.guarantees) {",
									"            pm.expect(item.guarantees, `Item ${index} guarantees type`).to.be.an('array');",
									"        }",
									"        ",
									"        if (item.insuranceCards) {",
									"            pm.expect(item.insuranceCards, `Item ${index} insuranceCards type`).to.be.an('array');",
									"        }",
									"        ",
									"        if (item.clauses) {",
									"            pm.expect(item.clauses, `Item ${index} clauses type`).to.be.an('array');",
									"        }",
									"        ",
									"        if (item.address) {",
									"            pm.expect(item.address, `Item ${index} address type`).to.be.an('object');",
									"        }",
									"    });",
									"});",
									"",
									"// ===================================",
									"// 4. DATA INTEGRITY AND BUSINESS RULES",
									"// ===================================",
									"pm.test(\"Date fields have valid ISO 8601 format\", function () {",
									"    const jsonData = pm.response.json();",
									"    const iso8601Regex = /^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{3})?Z$/;",
									"    ",
									"    jsonData.items.forEach(function (item, index) {",
									"        if (item.policyInceptionDate) {",
									"            pm.expect(item.policyInceptionDate, `Item ${index} policyInceptionDate format`).to.match(iso8601Regex);",
									"        }",
									"        if (item.policyStartDate) {",
									"            pm.expect(item.policyStartDate, `Item ${index} policyStartDate format`).to.match(iso8601Regex);",
									"        }",
									"        if (item.policyEndDate) {",
									"            pm.expect(item.policyEndDate, `Item ${index} policyEndDate format`).to.match(iso8601Regex);",
									"        }",
									"    });",
									"});",
									"",
									"pm.test(\"Policy dates are in logical order (inception <= start <= end)\", function () {",
									"    const jsonData = pm.response.json();",
									"    ",
									"    jsonData.items.forEach(function (item, index) {",
									"        const inception = new Date(item.policyInceptionDate);",
									"        const start = new Date(item.policyStartDate);",
									"        const end = new Date(item.policyEndDate);",
									"        ",
									"        pm.expect(inception.getTime(), `Item ${index} inception before or equal to start`).to.be.at.most(start.getTime());",
									"        pm.expect(start.getTime(), `Item ${index} start before or equal to end`).to.be.at.most(end.getTime());",
									"    });",
									"});",
									"",
									"pm.test(\"ThirdPartyInternalId matches query parameter\", function () {",
									"    const jsonData = pm.response.json();",
									"    const queryThirdPartyId = pm.request.url.query.get('thirdPartyInternalId');",
									"    ",
									"    if (queryThirdPartyId) {",
									"        jsonData.items.forEach(function (item, index) {",
									"            pm.expect(item.thirdPartyInternalId, `Item ${index} thirdPartyInternalId matches query`).to.equal(queryThirdPartyId);",
									"        });",
									"    }",
									"});",
									"",
									"pm.test(\"Policy numbers are not empty\", function () {",
									"    const jsonData = pm.response.json();",
									"    ",
									"    jsonData.items.forEach(function (item, index) {",
									"        pm.expect(item.policyNumber, `Item ${index} policyNumber not empty`).to.not.be.empty;",
									"    });",
									"});",
									"",
									"pm.test(\"Commercial and service mode codes are not empty arrays\", function () {",
									"    const jsonData = pm.response.json();",
									"    ",
									"    jsonData.items.forEach(function (item, index) {",
									"        pm.expect(item.commercialModeCodes.length, `Item ${index} commercialModeCodes not empty`).to.be.at.least(1);",
									"        pm.expect(item.serviceModeCodes.length, `Item ${index} serviceModeCodes not empty`).to.be.at.least(1);",
									"    });",
									"});",
									"",
									"pm.test(\"Guarantees have required fields when present\", function () {",
									"    const jsonData = pm.response.json();",
									"    ",
									"    jsonData.items.forEach(function (item, index) {",
									"        if (item.guarantees && item.guarantees.length > 0) {",
									"            item.guarantees.forEach(function (guarantee, gIndex) {",
									"                pm.expect(guarantee, `Item ${index} guarantee ${gIndex} has guaranteeId`).to.have.property('guaranteeId');",
									"                pm.expect(guarantee, `Item ${index} guarantee ${gIndex} has description`).to.have.property('description');",
									"                pm.expect(guarantee, `Item ${index} guarantee ${gIndex} has registerDate`).to.have.property('registerDate');",
									"                pm.expect(guarantee, `Item ${index} guarantee ${gIndex} has effectiveDate`).to.have.property('effectiveDate');",
									"            });",
									"        }",
									"    });",
									"});",
									"",
									"pm.test(\"Insurance cards have valid status codes when present\", function () {",
									"    const jsonData = pm.response.json();",
									"    ",
									"    jsonData.items.forEach(function (item, index) {",
									"        if (item.insuranceCards && item.insuranceCards.length > 0) {",
									"            item.insuranceCards.forEach(function (card, cIndex) {",
									"                pm.expect(card, `Item ${index} card ${cIndex} has statusCode`).to.have.property('statusCode');",
									"                pm.expect(card.statusCode, `Item ${index} card ${cIndex} statusCode not empty`).to.not.be.empty;",
									"            });",
									"        }",
									"    });",
									"});",
									"",
									"// ===================================",
									"// 5. PERFORMANCE AND RESPONSE TIME",
									"// ===================================",
									"pm.test(\"Response time is less than 500ms\", function () {",
									"    pm.expect(pm.response.responseTime).to.be.below(500);",
									"});",
									"",
									"pm.test(\"Response time is less than 500ms (acceptable threshold)\", function () {",
									"    pm.expect(pm.response.responseTime).to.be.below(500);",
									"});",
									"",
									"pm.test(\"Response size is reasonable (less than 5MB)\", function () {",
									"    const responseSize = pm.response.responseSize;",
									"    pm.expect(responseSize).to.be.below(5 * 1024 * 1024);",
									"});",
									"",
									"// ===================================",
									"// 6. ERROR HANDLING SCENARIOS",
									"// ===================================",
									"pm.test(\"No server errors (5xx status codes)\", function () {",
									"    pm.expect(pm.response.code).to.be.below(500);",
									"});",
									"",
									"pm.test(\"Response body is not empty\", function () {",
									"    pm.expect(pm.response.text()).to.not.be.empty;",
									"});",
									"",
									"pm.test(\"No null values in critical fields\", function () {",
									"    const jsonData = pm.response.json();",
									"    ",
									"    jsonData.items.forEach(function (item, index) {",
									"        pm.expect(item.policyNumber, `Item ${index} policyNumber not null`).to.not.be.null;",
									"        pm.expect(item.thirdPartyInternalId, `Item ${index} thirdPartyInternalId not null`).to.not.be.null;",
									"        pm.expect(item.systemCode, `Item ${index} systemCode not null`).to.not.be.null;",
									"    });",
									"});",
									"",
									"// Store results for reporting",
									"pm.collectionVariables.set('lastTestTimestamp', new Date().toISOString());",
									"pm.collectionVariables.set('lastResponseTime', pm.response.responseTime);",
									"pm.collectionVariables.set('lastItemCount', pm.response.json().items.length);"
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept-Language",
								"value": "es-ES",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{DNSstorage}}/workshop/v1/insurance_policies-photos/search?thirdPartyInternalId=330749452011&pageNumber=1&pageSize=10",
							"host": [
								"{{DNSstorage}}"
							],
							"path": [
								"workshop",
								"v1",
								"insurance_policies-photos",
								"search"
							],
							"query": [
								{
									"key": "id",
									"value": null,
									"disabled": true
								},
								{
									"key": "policyNumber",
									"value": null,
									"disabled": true
								},
								{
									"key": "thirdPartyInternalId",
									"value": "330749452011"
								},
								{
									"key": "date",
									"value": null,
									"disabled": true
								},
								{
									"key": "sortBy",
									"value": null,
									"disabled": true
								},
								{
									"key": "sortOrder",
									"value": null,
									"disabled": true
								},
								{
									"key": "fullTextSearch",
									"value": null,
									"disabled": true
								},
								{
									"key": "status",
									"value": null,
									"disabled": true
								},
								{
									"key": "pageNumber",
									"value": "1"
								},
								{
									"key": "pageSize",
									"value": "10"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Insured policy cod_int Not Found",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"",
									"// Verificar que el status code sea 200",
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"// Validar que el tiempo de respuesta sea menor a 2 segundos",
									"pm.test(\"Response time is less than 2000ms\", function () {",
									"    pm.expect(pm.response.responseTime).to.be.below(2000);",
									"});",
									"",
									"// Parsear el body como JSON",
									"let jsonData = pm.response.json();",
									"",
									"// Validar estructura principal",
									"pm.test(\"Response has correct structure\", function () {",
									"    pm.expect(jsonData).to.have.property('pageSize');",
									"    pm.expect(jsonData).to.have.property('pageNumber');",
									"    pm.expect(jsonData).to.have.property('totalPages');",
									"    pm.expect(jsonData).to.have.property('totalElements');",
									"    pm.expect(jsonData).to.have.property('items');",
									"});",
									"",
									"// Validar valores esperados",
									"pm.test(\"Pagination values are correct\", function () {",
									"    pm.expect(jsonData.pageSize).to.eql(10);",
									"    pm.expect(jsonData.pageNumber).to.eql(1);",
									"    pm.expect(jsonData.totalPages).to.eql(1);",
									"    pm.expect(jsonData.totalElements).to.eql(0);",
									"});",
									"",
									"// Validar que items es un array vacío",
									"pm.test(\"'items' is an empty array\", function () {",
									"    pm.expect(jsonData.items).to.be.an('array').that.is.empty;",
									"});",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept-Language",
								"value": "es-ES",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{DNSstorage}}/workshop/v1/insurance_policies-photos/search?thirdPartyInternalId=3307494520110&pageNumber=1&pageSize=10",
							"host": [
								"{{DNSstorage}}"
							],
							"path": [
								"workshop",
								"v1",
								"insurance_policies-photos",
								"search"
							],
							"query": [
								{
									"key": "id",
									"value": "",
									"disabled": true
								},
								{
									"key": "policyNumber",
									"value": "",
									"disabled": true
								},
								{
									"key": "thirdPartyInternalId",
									"value": "3307494520110"
								},
								{
									"key": "date",
									"value": "",
									"disabled": true
								},
								{
									"key": "sortBy",
									"value": "",
									"disabled": true
								},
								{
									"key": "sortOrder",
									"value": "",
									"disabled": true
								},
								{
									"key": "fullTextSearch",
									"value": "",
									"disabled": true
								},
								{
									"key": "status",
									"value": "",
									"disabled": true
								},
								{
									"key": "pageNumber",
									"value": "1"
								},
								{
									"key": "pageSize",
									"value": "10"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Insured policy cod_int KO",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"",
									"// Verificar que el status code sea 500",
									"pm.test(\"Status code is 500\", function () {",
									"    pm.response.to.have.status(500);",
									"});",
									"",
									"// Comprobar que el Content-Type sea JSON",
									"/*pm.test(\"Content-Type is application/json\", function () {",
									"    pm.response.to.have.header(\"Content-Type\", /application\\/json/);",
									"});*/",
									"",
									"// Parsear el body como JSON",
									"let jsonData = pm.response.json();",
									"",
									"// Validar estructura esperada",
									"pm.test(\"Error response has correct structure\", function () {",
									"    pm.expect(jsonData).to.have.property('statusCode');",
									"    pm.expect(jsonData).to.have.property('errorCode');",
									"    pm.expect(jsonData).to.have.property('errorMessage');",
									"    pm.expect(jsonData).to.have.property('errorData');",
									"    pm.expect(jsonData).to.have.property('timestamp');",
									"    pm.expect(jsonData).to.have.property('path');",
									"    pm.expect(jsonData).to.have.property('requestId');",
									"});",
									"",
									"// Validar valores esperados",
									"pm.test(\"Error values are correct\", function () {",
									"    pm.expect(jsonData.statusCode).to.eql(500);",
									"    pm.expect(jsonData.errorCode).to.eql(\"PLAT:STORAGE:UNKNOWN_CODE\");",
									"    pm.expect(jsonData.errorMessage).to.eql(\"Internal Server Error\");",
									"});",
									"",
									"// Validar tipos de datos",
									"pm.test(\"Data types are correct\", function () {",
									"    pm.expect(jsonData.statusCode).to.be.a('number');",
									"    pm.expect(jsonData.errorCode).to.be.a('string');",
									"    pm.expect(jsonData.errorMessage).to.be.a('string');",
									"    pm.expect(jsonData.errorData).to.be.an('array');",
									"    pm.expect(jsonData.timestamp).to.be.a('string');",
									"    pm.expect(jsonData.path).to.be.a('string');",
									"    pm.expect(jsonData.requestId).to.be.a('string');",
									"});",
									"",
									"// Validar que errorData esté vacío",
									"pm.test(\"'errorData' is an empty array\", function () {",
									"    pm.expect(jsonData.errorData).to.be.an('array').that.is.empty;",
									"});",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept-Language",
								"value": "es-ES",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{DNSstorage}}/workshop/v1/insurance_policies-photos/search?policyNumber=prueba&thirdPartyInternalId=330749452011&pageNumber=1&pageSize=10",
							"host": [
								"{{DNSstorage}}"
							],
							"path": [
								"workshop",
								"v1",
								"insurance_policies-photos",
								"search"
							],
							"query": [
								{
									"key": "id",
									"value": "",
									"disabled": true
								},
								{
									"key": "policyNumber",
									"value": "prueba"
								},
								{
									"key": "thirdPartyInternalId",
									"value": "330749452011"
								},
								{
									"key": "date",
									"value": "prueba",
									"disabled": true
								},
								{
									"key": "sortBy",
									"value": "",
									"disabled": true
								},
								{
									"key": "sortOrder",
									"value": "",
									"disabled": true
								},
								{
									"key": "fullTextSearch",
									"value": "",
									"disabled": true
								},
								{
									"key": "status",
									"value": "",
									"disabled": true
								},
								{
									"key": "pageNumber",
									"value": "1"
								},
								{
									"key": "pageSize",
									"value": "10"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Insured policy cod_int OK Date",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// ===================================",
									"// 1. RESPONSE STRUCTURE AND STATUS",
									"// ===================================",
									"pm.test(\"Status code is 200 (OK)\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has valid JSON body\", function () {",
									"    pm.response.to.be.json;",
									"});",
									"",
									"pm.test(\"Response has required root-level fields\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('pageSize');",
									"    pm.expect(jsonData).to.have.property('pageNumber');",
									"    pm.expect(jsonData).to.have.property('totalPages');",
									"    pm.expect(jsonData).to.have.property('totalElements');",
									"    pm.expect(jsonData).to.have.property('items');",
									"});",
									"",
									"pm.test(\"Response Content-Type header is application/json\", function () {",
									"    pm.expect(pm.response.headers.get('Content-Type')).to.include('application/json');",
									"});",
									"",
									"// ===================================",
									"// 2. PAGINATION DETAILS",
									"// ===================================",
									"pm.test(\"Pagination fields have correct data types\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData.pageSize).to.be.a('number');",
									"    pm.expect(jsonData.pageNumber).to.be.a('number');",
									"    pm.expect(jsonData.totalPages).to.be.a('number');",
									"    pm.expect(jsonData.totalElements).to.be.a('number');",
									"});",
									"",
									"pm.test(\"Pagination values are valid\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData.pageSize).to.be.at.least(0);",
									"    pm.expect(jsonData.pageNumber).to.be.at.least(1);",
									"    pm.expect(jsonData.totalPages).to.be.at.least(0);",
									"    pm.expect(jsonData.totalElements).to.be.at.least(0);",
									"});",
									"",
									"pm.test(\"Items array length does not exceed pageSize\", function () {",
									"    const jsonData = pm.response.json();",
									"    if (jsonData.items!=null){pm.expect(jsonData.items.length).to.be.at.most(jsonData.pageSize);}",
									"});",
									"",
									"pm.test(\"Total pages calculation is correct\", function () {",
									"    const jsonData = pm.response.json();",
									"    const expectedTotalPages = jsonData.pageSize > 0 ? Math.ceil(jsonData.totalElements / jsonData.pageSize) : 0;",
									"    pm.expect(jsonData.totalPages).to.equal(expectedTotalPages);",
									"});",
									"",
									"// ===================================",
									"// 3. ITEM DETAILS AND MANDATORY FIELDS",
									"// ===================================",
									"pm.test(\"Items is an array\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData.items).to.be.an('array');",
									"});",
									"",
									"pm.test(\"Each item has all mandatory fields\", function () {",
									"    const jsonData = pm.response.json();",
									"    const mandatoryFields = [",
									"        'portfolioId', 'policyNumber', 'policyInceptionDate', ",
									"        'policyStartDate', 'policyEndDate', 'thirdPartyInternalId',",
									"        'systemCode', 'commercialModeCodes', 'serviceModeCodes'",
									"    ];",
									"    ",
									"    jsonData.items.forEach(function (item, index) {",
									"        mandatoryFields.forEach(function (field) {",
									"            pm.expect(item, `Item ${index} missing field: ${field}`).to.have.property(field);",
									"        });",
									"    });",
									"});",
									"",
									"pm.test(\"Each item has valid field types\", function () {",
									"    const jsonData = pm.response.json();",
									"    ",
									"    jsonData.items.forEach(function (item, index) {",
									"        pm.expect(item.portfolioId, `Item ${index} portfolioId type`).to.be.a('string');",
									"        pm.expect(item.policyNumber, `Item ${index} policyNumber type`).to.be.a('string');",
									"        pm.expect(item.policyInceptionDate, `Item ${index} policyInceptionDate type`).to.be.a('string');",
									"        pm.expect(item.policyStartDate, `Item ${index} policyStartDate type`).to.be.a('string');",
									"        pm.expect(item.policyEndDate, `Item ${index} policyEndDate type`).to.be.a('string');",
									"        pm.expect(item.thirdPartyInternalId, `Item ${index} thirdPartyInternalId type`).to.be.a('string');",
									"        pm.expect(item.systemCode, `Item ${index} systemCode type`).to.be.a('string');",
									"        pm.expect(item.commercialModeCodes, `Item ${index} commercialModeCodes type`).to.be.an('array');",
									"        pm.expect(item.serviceModeCodes, `Item ${index} serviceModeCodes type`).to.be.an('array');",
									"    });",
									"});",
									"",
									"pm.test(\"Each item has valid nested structures\", function () {",
									"    const jsonData = pm.response.json();",
									"    ",
									"    jsonData.items.forEach(function (item, index) {",
									"        if (item.policyStatus) {",
									"            pm.expect(item.policyStatus, `Item ${index} policyStatus type`).to.be.an('object');",
									"            pm.expect(item.policyStatus).to.have.property('statusCode');",
									"        }",
									"        ",
									"        if (item.guarantees) {",
									"            pm.expect(item.guarantees, `Item ${index} guarantees type`).to.be.an('array');",
									"        }",
									"        ",
									"        if (item.insuranceCards) {",
									"            pm.expect(item.insuranceCards, `Item ${index} insuranceCards type`).to.be.an('array');",
									"        }",
									"        ",
									"        if (item.clauses) {",
									"            pm.expect(item.clauses, `Item ${index} clauses type`).to.be.an('array');",
									"        }",
									"        ",
									"        if (item.address) {",
									"            pm.expect(item.address, `Item ${index} address type`).to.be.an('object');",
									"        }",
									"    });",
									"});",
									"",
									"// ===================================",
									"// 4. DATA INTEGRITY AND BUSINESS RULES",
									"// ===================================",
									"pm.test(\"Date fields have valid ISO 8601 format\", function () {",
									"    const jsonData = pm.response.json();",
									"    const iso8601Regex = /^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{3})?Z$/;",
									"    ",
									"    jsonData.items.forEach(function (item, index) {",
									"        if (item.policyInceptionDate) {",
									"            pm.expect(item.policyInceptionDate, `Item ${index} policyInceptionDate format`).to.match(iso8601Regex);",
									"        }",
									"        if (item.policyStartDate) {",
									"            pm.expect(item.policyStartDate, `Item ${index} policyStartDate format`).to.match(iso8601Regex);",
									"        }",
									"        if (item.policyEndDate) {",
									"            pm.expect(item.policyEndDate, `Item ${index} policyEndDate format`).to.match(iso8601Regex);",
									"        }",
									"    });",
									"});",
									"",
									"pm.test(\"Policy dates are in logical order (inception <= start <= end)\", function () {",
									"    const jsonData = pm.response.json();",
									"    ",
									"    jsonData.items.forEach(function (item, index) {",
									"        const inception = new Date(item.policyInceptionDate);",
									"        const start = new Date(item.policyStartDate);",
									"        const end = new Date(item.policyEndDate);",
									"        ",
									"        pm.expect(inception.getTime(), `Item ${index} inception before or equal to start`).to.be.at.most(start.getTime());",
									"        pm.expect(start.getTime(), `Item ${index} start before or equal to end`).to.be.at.most(end.getTime());",
									"    });",
									"});",
									"",
									"pm.test(\"ThirdPartyInternalId matches query parameter\", function () {",
									"    const jsonData = pm.response.json();",
									"    const queryThirdPartyId = pm.request.url.query.get('thirdPartyInternalId');",
									"    ",
									"    if (queryThirdPartyId) {",
									"        jsonData.items.forEach(function (item, index) {",
									"            pm.expect(item.thirdPartyInternalId, `Item ${index} thirdPartyInternalId matches query`).to.equal(queryThirdPartyId);",
									"        });",
									"    }",
									"});",
									"",
									"pm.test(\"Policy numbers are not empty\", function () {",
									"    const jsonData = pm.response.json();",
									"    ",
									"    jsonData.items.forEach(function (item, index) {",
									"        pm.expect(item.policyNumber, `Item ${index} policyNumber not empty`).to.not.be.empty;",
									"    });",
									"});",
									"",
									"pm.test(\"Commercial and service mode codes are not empty arrays\", function () {",
									"    const jsonData = pm.response.json();",
									"    if (jsonData.items!=null){",
									"    jsonData.items.forEach(function (item, index) {",
									"        pm.expect(item.commercialModeCodes.length, `Item ${index} commercialModeCodes not empty`).to.be.at.least(1);",
									"        pm.expect(item.serviceModeCodes.length, `Item ${index} serviceModeCodes not empty`).to.be.at.least(1);",
									"    });",
									"    }",
									"});",
									"",
									"pm.test(\"Guarantees have required fields when present\", function () {",
									"    const jsonData = pm.response.json();",
									"    if (jsonData.items!=null){",
									"    jsonData.items.forEach(function (item, index) {",
									"        if (item.guarantees && item.guarantees.length > 0) {",
									"            item.guarantees.forEach(function (guarantee, gIndex) {",
									"                pm.expect(guarantee, `Item ${index} guarantee ${gIndex} has guaranteeId`).to.have.property('guaranteeId');",
									"                pm.expect(guarantee, `Item ${index} guarantee ${gIndex} has description`).to.have.property('description');",
									"                pm.expect(guarantee, `Item ${index} guarantee ${gIndex} has registerDate`).to.have.property('registerDate');",
									"                pm.expect(guarantee, `Item ${index} guarantee ${gIndex} has effectiveDate`).to.have.property('effectiveDate');",
									"            });",
									"        }",
									"    });",
									"    }",
									"});",
									"",
									"pm.test(\"Insurance cards have valid status codes when present\", function () {",
									"    const jsonData = pm.response.json();",
									"    if (jsonData.items!=null){",
									"    jsonData.items.forEach(function (item, index) {",
									"        if (item.insuranceCards && item.insuranceCards.length > 0) {",
									"            item.insuranceCards.forEach(function (card, cIndex) {",
									"                pm.expect(card, `Item ${index} card ${cIndex} has statusCode`).to.have.property('statusCode');",
									"                pm.expect(card.statusCode, `Item ${index} card ${cIndex} statusCode not empty`).to.not.be.empty;",
									"            });",
									"        }",
									"    });",
									"    }",
									"});",
									"",
									"// ===================================",
									"// 5. PERFORMANCE AND RESPONSE TIME",
									"// ===================================",
									"pm.test(\"Response time is less than 500ms\", function () {",
									"    pm.expect(pm.response.responseTime).to.be.below(500);",
									"});",
									"",
									"pm.test(\"Response time is less than 500ms (acceptable threshold)\", function () {",
									"    pm.expect(pm.response.responseTime).to.be.below(500);",
									"});",
									"",
									"pm.test(\"Response size is reasonable (less than 5MB)\", function () {",
									"    const responseSize = pm.response.responseSize;",
									"    pm.expect(responseSize).to.be.below(5 * 1024 * 1024);",
									"});",
									"",
									"// ===================================",
									"// 6. ERROR HANDLING SCENARIOS",
									"// ===================================",
									"pm.test(\"No server errors (5xx status codes)\", function () {",
									"    pm.expect(pm.response.code).to.be.below(500);",
									"});",
									"",
									"pm.test(\"Response body is not empty\", function () {",
									"    pm.expect(pm.response.text()).to.not.be.empty;",
									"});",
									"",
									"pm.test(\"No null values in critical fields\", function () {",
									"    const jsonData = pm.response.json();",
									"    if (jsonData.items!=null){",
									"    jsonData.items.forEach(function (item, index) {",
									"        pm.expect(item.policyNumber, `Item ${index} policyNumber not null`).to.not.be.null;",
									"        pm.expect(item.thirdPartyInternalId, `Item ${index} thirdPartyInternalId not null`).to.not.be.null;",
									"        pm.expect(item.systemCode, `Item ${index} systemCode not null`).to.not.be.null;",
									"    });",
									"    }",
									"});",
									"",
									"// Store results for reporting",
									"pm.collectionVariables.set('lastTestTimestamp', new Date().toISOString());",
									"pm.collectionVariables.set('lastResponseTime', pm.response.responseTime);",
									"pm.collectionVariables.set('lastItemCount', pm.response.json().items.length);"
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept-Language",
								"value": "es-ES",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{DNSstorage}}/workshop/v1/insurance_policies-photos/search?thirdPartyInternalId=330749452011&date=2025-12-31T00:00:00.000Z&pageNumber=1&pageSize=10",
							"host": [
								"{{DNSstorage}}"
							],
							"path": [
								"workshop",
								"v1",
								"insurance_policies-photos",
								"search"
							],
							"query": [
								{
									"key": "id",
									"value": "",
									"disabled": true
								},
								{
									"key": "policyNumber",
									"value": "",
									"disabled": true
								},
								{
									"key": "thirdPartyInternalId",
									"value": "330749452011"
								},
								{
									"key": "date",
									"value": "2025-12-31T00:00:00.000Z"
								},
								{
									"key": "sortBy",
									"value": "",
									"disabled": true
								},
								{
									"key": "sortOrder",
									"value": "",
									"disabled": true
								},
								{
									"key": "fullTextSearch",
									"value": "",
									"disabled": true
								},
								{
									"key": "status",
									"value": "",
									"disabled": true
								},
								{
									"key": "pageNumber",
									"value": "1"
								},
								{
									"key": "pageSize",
									"value": "10"
								}
							]
						}
					},
					"response": []
				}
			],
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"type": "text/javascript",
						"packages": {},
						"requests": {},
						"exec": [
							""
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"type": "text/javascript",
						"requests": {},
						"exec": [
							""
						]
					}
				}
			]
		},
		{
			"name": "GroupPolicy Regresion Pendiente",
			"item": [
				{
					"name": "GroupPolicyByPolicyNumber",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response time is less than 200ms\", function () {",
									"    pm.expect(pm.response.responseTime).to.be.below(200);",
									"});",
									"",
									"pm.test(\"Response body has the correct pageSize\", function () {",
									"    pm.expect(pm.response.json().pageSize).to.equal(2);",
									"});",
									"",
									"pm.test(\"Response body has the correct pageNumber\", function () {",
									"    pm.expect(pm.response.json().pageNumber).to.equal(1);",
									"});",
									"",
									"pm.test(\"Response body has the correct totalElements\", function () {",
									"    pm.expect(pm.response.json().totalElements).to.equal(2);",
									"});",
									"",
									"pm.test(\"Response body has the items array\", function () {",
									"    pm.expect(pm.response.json().items).to.be.an('array');",
									"});",
									"",
									"pm.test(\"Each item in the items array has the required fields\", function () {",
									"    pm.response.json().items.forEach(function (item) {",
									"        //pm.expect(item).to.have.property('id');",
									"        //pm.expect(item).to.have.property('systemCode');",
									"        pm.expect(item).to.have.property('guaranteeCode');",
									"        //pm.expect(item).to.have.property('lineOfBusinessCode');",
									"        pm.expect(item).to.have.property('registerDate');",
									"        pm.expect(item).to.have.property('status');",
									"        //pm.expect(item).to.have.property('accountingBranchCode');",
									"        //pm.expect(item).to.have.property('coverageCodes');",
									"        pm.expect(item).to.have.property('commercialModeCodes');",
									"        pm.expect(item).to.have.property('serviceModeCodes');",
									"        //pm.expect(item).to.have.property('currencyCode');",
									"        //pm.expect(item).to.have.property('metadata');",
									"    });",
									"});",
									"",
									"pm.test(\"Each item in de items array has status field not equals than COMPLETED\", function() {",
									"    pm.response.json().items.forEach(function (item) {",
									"        pm.expect(item.status).to.not.equal(\"COMPLETED\");",
									"    })",
									"})",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept-Language",
								"value": "es-ES",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{DNSstorage}}/workshop/v1/group_policies-photos/search?policyNumber=9474230&pageNumber=1&pageSize=10",
							"host": [
								"{{DNSstorage}}"
							],
							"path": [
								"workshop",
								"v1",
								"group_policies-photos",
								"search"
							],
							"query": [
								{
									"key": "id",
									"value": null,
									"disabled": true
								},
								{
									"key": "policyNumber",
									"value": "9474230"
								},
								{
									"key": "date",
									"value": null,
									"disabled": true
								},
								{
									"key": "sortBy",
									"value": null,
									"disabled": true
								},
								{
									"key": "sortOrder",
									"value": null,
									"disabled": true
								},
								{
									"key": "fullTextSearch",
									"value": null,
									"disabled": true
								},
								{
									"key": "status",
									"value": null,
									"disabled": true
								},
								{
									"key": "pageNumber",
									"value": "1"
								},
								{
									"key": "pageSize",
									"value": "10"
								}
							]
						}
					},
					"response": []
				}
			],
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"type": "text/javascript",
						"packages": {},
						"requests": {},
						"exec": [
							""
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"type": "text/javascript",
						"requests": {},
						"exec": [
							""
						]
					}
				}
			]
		}
	],
	"auth": {
		"type": "oauth2",
		"oauth2": [
			{
				"key": "clientId",
				"value": "bc8307d2-72a9-4800-a14c-778a9367a56e",
				"type": "string"
			},
			{
				"key": "scope",
				"value": "api://bc8307d2-72a9-4800-a14c-778a9367a56e/providers api://bc8307d2-72a9-4800-a14c-778a9367a56e/assistance api://bc8307d2-72a9-4800-a14c-778a9367a56e/support api://bc8307d2-72a9-4800-a14c-778a9367a56e/nomenclator api://bc8307d2-72a9-4800-a14c-778a9367a56e/integration api://bc8307d2-72a9-4800-a14c-778a9367a56e/platform",
				"type": "string"
			},
			{
				"key": "accessTokenUrl",
				"value": "https://login.microsoftonline.com/93ad25dd-8cdc-4066-9727-31a8a3024f80/oauth2/v2.0/token",
				"type": "string"
			},
			{
				"key": "authUrl",
				"value": "https://login.microsoftonline.com/93ad25dd-8cdc-4066-9727-31a8a3024f80/oauth2/v2.0/authorize",
				"type": "string"
			},
			{
				"key": "useBrowser",
				"value": true,
				"type": "boolean"
			},
			{
				"key": "client_authentication",
				"value": "body",
				"type": "string"
			},
			{
				"key": "grant_type",
				"value": "authorization_code",
				"type": "string"
			},
			{
				"key": "addTokenTo",
				"value": "header",
				"type": "string"
			}
		]
	},
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"requests": {},
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"requests": {},
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "Client ID",
			"value": "bc8307d2-72a9-4800-a14c-778a9367a56e\n "
		},
		{
			"key": "lastTestTimestamp",
			"value": ""
		},
		{
			"key": "lastResponseTime",
			"value": ""
		},
		{
			"key": "lastItemCount",
			"value": ""
		}
	]
}